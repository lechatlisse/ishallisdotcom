/* ==========================================================================
   Core tokens
   ========================================================================== */
:root{
  --bg: #000;
  --fg: #fff;
  --accent: red;

  --gap: clamp(12px, 2vw, 28px);
  --radius: 3px;
  --header-h: 50px;

  --z-progress: 10100;
  --z-header: 10050;
  --z-overlay: 10000;
}

/* ==========================================================================
   Base document
   ========================================================================== */
*,*::before,*::after{ box-sizing:border-box }
html,body{ height:100% }
html{ -webkit-text-size-adjust:100% }
body{
  margin:0;
  background:var(--bg);
  color:var(--fg);
  font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
img,video,svg,canvas{ display:block; max-width:100%; height:auto }
a{ color:inherit; text-decoration:none }
::selection{ background:#000; color:#fff }

/* Simple utility */
.hidden{ display:none !important }

/* ==========================================================================
   Thin progress bar (JS drives --progress)
   ========================================================================== */
#progress{
  position:fixed; top:0; left:0; right:0;
  height:3px;
  z-index:var(--z-progress);
  pointer-events:none;
}
#progress::before{
  content:"";
  position:absolute; inset:0;
  background:var(--accent);
  opacity:.9;
  transform-origin:left;
  transform:scaleX(var(--progress, 0));
  transition:transform .25s ease, opacity .35s ease .2s;
}
#progress.done{ opacity:0 }

/* ==========================================================================
   Header (single instance, always above overlay)
   ========================================================================== */
.site-header{
  position:fixed; top:0; left:0; right:0; height:var(--header-h);
  z-index:var(--z-header);
  color:var(--fg);
  text-transform:uppercase; letter-spacing:.1em;
  mix-blend-mode:difference; /* your current style */
  transition:background .75s linear;
}
.site-header .header-inner{
  height:100%; display:flex; align-items:center; justify-content:space-between;
  padding:0 20px;
}
.site-header .brand a{ display:inline-block; padding:10px 0; font-size:15px }
.site-header .site-nav .nav-list{ display:flex; align-items:center; gap:10px; margin:0; padding:0; list-style:none }
.site-header .nav-insta img{ width:13px; height:16px }
.site-header a:hover{ color:var(--accent) }

/* Keep header readable over dark overlay */
html.modal-open .site-header{ mix-blend-mode:normal }

/* ==========================================================================
   Main content + fade-in (JS removes .fade)
   ========================================================================== */
#content{ opacity:1; transition:opacity 1.2s }
#content.fade{ opacity:0; transition:none }

/* ==========================================================================
   Project card geometry (hero + tiles share this)
   ========================================================================== */
.project{
  position:relative; display:block;
  aspect-ratio:16/9;
  border-radius:var(--radius);
  overflow:hidden;
}
.project > :is(video,img,iframe){
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit:cover; border:0;
  background:#000;
}

/* Hero (non-clickable) spacing */
.project.hero-tile{ margin-bottom:var(--gap) }

/* ==========================================================================
   Projects grid (2–1–2–1 cadence)
   ========================================================================== */
.projects .grid{
  display:grid;
  grid-template-columns:repeat(2, minmax(0,1fr));
  gap:var(--gap);
  align-items:start;
  grid-auto-flow:dense;
}
.projects .grid > a.project{ color:inherit }
.projects .grid > a.project:nth-child(3n){ grid-column:1 / -1 }

/* Aspect-ratio fallback for very old browsers */
@supports not (aspect-ratio: 1/1){
  .project::before{ content:""; display:block; padding-top:56.25% }
  .project > :is(video,img,iframe){ position:absolute }
}

/* Overlay text (title centered, others below, auto-collapse empties) */
.project .overlay{
  position:absolute; inset:0;
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  text-align:center; color:#fff; padding:clamp(8px, 2vw, 24px);
  pointer-events:none;
}
.project .title{
  font-weight:700; line-height:1.2;
  font-size:clamp(1rem, 2.2vw + .5rem, 2.4rem);
  margin:.15em 0; max-width:90%;
  text-wrap:balance;
}
.project .subtitle{
  font-weight:500; line-height:1.2;
  font-size:clamp(.9rem, 1.6vw + .3rem, 1.3rem);
  margin:.15em 0;
}
.project .caption{
  font-weight:400; line-height:1.25;
  font-size:clamp(.8rem, 1.2vw + .2rem, 1.05rem);
  margin:.15em 0; opacity:.9;
}
.project .subtitle:empty, .project .caption:empty{ display:none }

/* Responsive single column */
@media (max-width: 660px){
  .projects .grid{ grid-template-columns:1fr }
  .projects .grid > a.project{ grid-column:1 / -1 }
}

/* ==========================================================================
   Fullscreen player overlay (no animations — pop on/off)
   ========================================================================== */
#player{
  position:fixed; inset:0;
  background:rgba(0,0,0,.85);
  z-index:var(--z-overlay);
}
#player .player-panel{ position:absolute; inset:0 }
#player .player-wrap{ position:absolute; inset:0; background:#000 }

/* Close button aligned below header line */
#player .player-close{
  position:absolute; top:calc(var(--header-h) + 12px); right:16px; 
  z-index: 20;
  width:40px; height:40px; line-height:40px; text-align:center;
  border:0; border-radius:999px; cursor:pointer;
  background:rgba(0,0,0,.5); color:#fff; font-size:20px;
  backdrop-filter:blur(6px);
}

/* Lock page scroll while overlay is open */
html.modal-open, body.modal-open{ overflow:hidden }

/* ============================================================
   PLYR: overlay + project pages (viewport-pinned controls)
   ============================================================ */

/* Optional theme knobs (tweak freely) */
.plyr{
  position: absolute; inset: 0;
  /* Primary accent (progress, focus, etc.) */
  --plyr-color-main: red;

  /* Subtle sizing tweaks (comment out if you like Plyr defaults) */
  --plyr-control-spacing: 10px;
  --plyr-control-padding: 6px;
  --plyr-range-track-height: 10px;
  --plyr-range-thumb-height: 12px;
  --plyr-range-thumb-width: 12px;
  
  /* optional: buffer/background tints to taste */
  --plyr-video-progress-buffered-background: rgba(255,255,255,0);
  --plyr-video-range-track-background: rgba(255,255,255,.15);
}

.plyr .poster-veil{
  position: absolute; inset: 0;
  background-position: center center;
  background-size: cover; background-repeat: no-repeat;
  opacity: 1; transition: opacity 1s ease;
  pointer-events: none;
  z-index: 1;
}

/* Controls container rounding (overlay + project pages) */
.plyr__controls{ 
  border-radius: 2px !important; 
  position: relative; 
  z-index: 3; 
}

/* Progress track rounding (wrapper + buffer + range) */
.plyr__progress,
.plyr__progress__buffer,
.plyr__progress input[type="range"]{
  border-radius: 2px !important;
}

/* Make sure the WebKit track matches thickness */
.plyr__progress input[type="range"]::-webkit-slider-runnable-track{
  height: var(--plyr-range-track-height) !important;
  border-radius: 2px !important;
}

/* ===== Plyr: remove diagonal buffering stripes ===== */
.plyr__progress__buffer {
  background: rgba(255,255,255,.25) !important; /* flat semi-transparent fill */
  background-image: none !important;            /* kill diagonal stripes */
  animation: none !important;                   /* stop the moving stripes */
}

/* ===== Plyr: remove big loading spinner ===== */
.plyr__spinner {
  display: none !important;
}

/* HIDE the scrubber knob (the white dot) — all engines */
.plyr--full-ui .plyr__progress input[type="range"]{
  -webkit-appearance:none; appearance:none;
  background: transparent; /* Plyr paints the bar; this keeps the input ‘invisible’ */
}
.plyr--full-ui .plyr__progress input[type="range"]::-webkit-slider-thumb{
  -webkit-appearance:none; appearance:none;
  width:0 !important; height:0 !important;
  background:transparent !important; border:0 !important; box-shadow:none !important;
}
.plyr--full-ui .plyr__progress input[type="range"]::-moz-range-thumb{
  width:0 !important; height:0 !important;
  background:transparent !important; border:0 !important; box-shadow:none !important;
}
.plyr--full-ui .plyr__progress input[type="range"]::-ms-thumb{
  width:0 !important; height:0 !important;
  background:transparent !important; border:0 !important; box-shadow:none !important;
}

/* Hide tooltip entirely */
.plyr__tooltip{ display:none !important; }

/* ========== Overlay ========== */
/* Keep your existing wrapper, but ensure it's the clipping viewport */
#player .player-wrap{ position:absolute; inset:0; overflow:hidden; }

/* Let Plyr fill that viewport-sized wrapper */
#player .player-wrap .plyr{ position:absolute; inset:0; }

/* Overscan the video plane to cover, but keep controls in-bounds
   (controls are positioned relative to the .plyr viewport wrapper) */
#player .player-wrap .plyr__video-embed{
  position:absolute; top:50%; left:50%;
  width:max(100vw, calc(100dvh * 16 / 9));
  height:max(100dvh, calc(100vw * 9 / 16));
  transform:translate(-50%, -50%);
  z-index: 1;
}

/* Pad controls a touch so they never hug the edges */
#player .player-wrap .plyr__controls{
  padding: clamp(8px, 1.6vw, 14px);
}

/* Ensure controls render above the poster layer */
.plyr__controls{ position:relative; z-index:3; }

/* Use Plyr's built-in poster layer; make it cover and fade nicely */
.plyr__poster{
  background-position: center !important;
  background-size: cover !important;
  background-repeat: no-repeat !important;
  opacity: 1;
  transition: opacity .5s ease;
}

/* ========== Project pages ========== */
/* Your 16:9 stage */
.project-page .video-embed{ position:relative; aspect-ratio:16/9; background:#000; }

/* Plyr fills that stage */
.project-page .video-embed .plyr{ position:absolute; inset:0; }

/* Vimeo plane sits inside the stage (no overscan here) */
.project-page .video-embed .plyr__video-embed{ position:absolute; inset:0; z-index: 1; }